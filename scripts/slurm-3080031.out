2023-05-01 17:29:47,344 - distributed.nanny - INFO -         Start Nanny at: 'tcp://172.16.3.161:40196'
2023-05-01 17:29:49,859 - distributed.worker - INFO -       Start worker at:   tcp://172.16.3.161:44129
2023-05-01 17:29:49,859 - distributed.worker - INFO -          Listening to:   tcp://172.16.3.161:44129
2023-05-01 17:29:49,859 - distributed.worker - INFO -           Worker name:             SLURMCluster-5
2023-05-01 17:29:49,859 - distributed.worker - INFO -          dashboard at:         172.16.3.161:46474
2023-05-01 17:29:49,859 - distributed.worker - INFO - Waiting to connect to:    tcp://172.16.3.62:37325
2023-05-01 17:29:49,859 - distributed.worker - INFO - -------------------------------------------------
2023-05-01 17:29:49,859 - distributed.worker - INFO -               Threads:                         36
2023-05-01 17:29:49,860 - distributed.worker - INFO -                Memory:                  46.57 GiB
2023-05-01 17:29:49,860 - distributed.worker - INFO -       Local Directory: /tmp/dask-worker-space/worker-45xzqg79
2023-05-01 17:29:49,860 - distributed.worker - INFO - -------------------------------------------------
2023-05-01 17:29:49,865 - distributed.worker - INFO -         Registered to:    tcp://172.16.3.62:37325
2023-05-01 17:29:49,865 - distributed.worker - INFO - -------------------------------------------------
2023-05-01 17:29:49,865 - distributed.core - INFO - Starting established connection to tcp://172.16.3.62:37325
/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/scipy/io/_netcdf.py:305: RuntimeWarning: Cannot close a netcdf_file opened with mmap=True, when netcdf_variables or arrays referring to its data still exist. All data arrays obtained from such files refer directly to data on disk, and must be copied before the file can be cleanly closed. (See netcdf_file docstring for more information on mmap.)
  warnings.warn((
2023-05-01 17:37:26,962 - distributed.core - INFO - Connection to tcp://172.16.3.62:37325 has been closed.
2023-05-01 17:37:26,963 - distributed.worker - INFO - Stopping worker at tcp://172.16.3.161:44129. Reason: worker-handle-scheduler-connection-broken
2023-05-01 17:37:26,964 - distributed.worker - ERROR - Failed to communicate with scheduler during heartbeat.
Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/tornado/iostream.py", line 861, in _read_to_buffer
    bytes_read = self.read_from_fd(buf)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/tornado/iostream.py", line 1116, in read_from_fd
    return self.socket.recv_into(buf, len(buf))
ConnectionResetError: [Errno 104] Connection reset by peer

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/worker.py", line 1234, in heartbeat
    response = await retry_operation(
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/utils_comm.py", line 434, in retry_operation
    return await retry(
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/utils_comm.py", line 413, in retry
    return await coro()
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/core.py", line 1268, in send_recv_from_rpc
    return await send_recv(comm=comm, op=key, **kwargs)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/core.py", line 1027, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 241, in read
    convert_stream_closed_error(self, e)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 142, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc.__class__.__name__}: {exc}") from exc
distributed.comm.core.CommClosedError: in <TCP (closed) ConnectionPool.heartbeat_worker local=tcp://172.16.3.161:54075 remote=tcp://172.16.3.62:37325>: ConnectionResetError: [Errno 104] Connection reset by peer
2023-05-01 17:37:26,974 - distributed.nanny - INFO - Closing Nanny gracefully at 'tcp://172.16.3.161:40196'. Reason: worker-handle-scheduler-connection-broken
2023-05-01 17:37:29,081 - distributed.client - ERROR - 
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/utils.py", line 1850, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 511, in connect
    convert_stream_closed_error(self, e)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 142, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc.__class__.__name__}: {exc}") from exc
distributed.comm.core.CommClosedError: in <distributed.comm.tcp.TCPConnector object at 0x2aab6bb5d060>: ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/utils.py", line 752, in wrapper
    return await func(*args, **kwargs)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/client.py", line 1321, in _reconnect
    await self._ensure_connected(timeout=timeout)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/client.py", line 1351, in _ensure_connected
    comm = await connect(
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/core.py", line 316, in connect
    await asyncio.sleep(backoff)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/asyncio/tasks.py", line 605, in sleep
    return await future
asyncio.exceptions.CancelledError
2023-05-01 17:37:59,086 - distributed.nanny - INFO - Worker closed
2023-05-01 17:38:01,876 - distributed.nanny - INFO - Closing Nanny at 'tcp://172.16.3.161:40196'. Reason: nanny-close-gracefully
2023-05-01 17:38:01,877 - distributed.dask_worker - INFO - End worker
