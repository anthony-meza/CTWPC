2023-05-04 14:58:09,816 - distributed.nanny - INFO -         Start Nanny at: 'tcp://172.16.3.103:45826'
2023-05-04 14:58:10,198 - distributed.diskutils - INFO - Found stale lock file and directory '/tmp/dask-worker-space/worker-t84zlaas', purging
2023-05-04 14:58:15,839 - distributed.worker - INFO -       Start worker at:   tcp://172.16.3.103:34301
2023-05-04 14:58:15,839 - distributed.worker - INFO -          Listening to:   tcp://172.16.3.103:34301
2023-05-04 14:58:15,839 - distributed.worker - INFO -           Worker name:            SLURMCluster-14
2023-05-04 14:58:15,839 - distributed.worker - INFO -          dashboard at:         172.16.3.103:42598
2023-05-04 14:58:15,839 - distributed.worker - INFO - Waiting to connect to:   tcp://172.16.3.106:43862
2023-05-04 14:58:15,839 - distributed.worker - INFO - -------------------------------------------------
2023-05-04 14:58:15,839 - distributed.worker - INFO -               Threads:                         36
2023-05-04 14:58:15,839 - distributed.worker - INFO -                Memory:                 178.81 GiB
2023-05-04 14:58:15,840 - distributed.worker - INFO -       Local Directory: /tmp/dask-worker-space/worker-2fns9vkn
2023-05-04 14:58:15,840 - distributed.worker - INFO - -------------------------------------------------
2023-05-04 14:58:15,845 - distributed.worker - INFO -         Registered to:   tcp://172.16.3.106:43862
2023-05-04 14:58:15,845 - distributed.worker - INFO - -------------------------------------------------
2023-05-04 14:58:15,846 - distributed.core - INFO - Starting established connection to tcp://172.16.3.106:43862
2023-05-04 15:24:44,861 - distributed.core - INFO - Removing comms to tcp://172.16.3.185:41432
2023-05-04 16:25:43,280 - distributed.core - INFO - Removing comms to tcp://172.16.3.65:37409
2023-05-04 16:25:43,286 - distributed.core - INFO - Removing comms to tcp://172.16.3.67:44799
2023-05-04 16:25:43,286 - distributed.core - INFO - Removing comms to tcp://172.16.3.63:33229
2023-05-04 16:25:43,294 - distributed.core - INFO - Removing comms to tcp://172.16.3.68:32915
2023-05-04 16:25:43,324 - distributed.core - INFO - Removing comms to tcp://172.16.3.64:40969
2023-05-04 16:25:43,337 - distributed.core - INFO - Removing comms to tcp://172.16.3.70:38567
2023-05-04 16:25:43,343 - distributed.core - INFO - Removing comms to tcp://172.16.3.69:44899
2023-05-04 16:43:42,924 - distributed.utils_perf - INFO - full garbage collection released 1.51 GiB from 1000 reference cycles (threshold: 9.54 MiB)
2023-05-04 16:43:56,584 - distributed.utils_perf - INFO - full garbage collection released 899.37 MiB from 680 reference cycles (threshold: 9.54 MiB)
2023-05-04 16:44:00,037 - distributed.utils_perf - INFO - full garbage collection released 727.54 MiB from 959 reference cycles (threshold: 9.54 MiB)
2023-05-04 16:44:03,364 - distributed.utils_perf - INFO - full garbage collection released 1.28 GiB from 1119 reference cycles (threshold: 9.54 MiB)
2023-05-04 16:44:21,075 - distributed.utils_perf - INFO - full garbage collection released 0.91 GiB from 1119 reference cycles (threshold: 9.54 MiB)
2023-05-04 16:44:26,390 - distributed.utils_perf - INFO - full garbage collection released 812.27 MiB from 1200 reference cycles (threshold: 9.54 MiB)
2023-05-04 16:44:31,476 - distributed.utils_perf - INFO - full garbage collection released 259.57 MiB from 1179 reference cycles (threshold: 9.54 MiB)
2023-05-04 16:44:36,378 - distributed.utils_perf - INFO - full garbage collection released 2.55 GiB from 599 reference cycles (threshold: 9.54 MiB)
2023-05-04 16:44:48,171 - distributed.utils_perf - INFO - full garbage collection released 0.99 GiB from 599 reference cycles (threshold: 9.54 MiB)
2023-05-04 16:44:55,463 - distributed.utils_perf - INFO - full garbage collection released 1.69 GiB from 699 reference cycles (threshold: 9.54 MiB)
2023-05-04 16:45:43,796 - distributed.utils_perf - INFO - full garbage collection released 27.72 MiB from 739 reference cycles (threshold: 9.54 MiB)
2023-05-04 16:46:28,149 - distributed.core - INFO - Event loop was unresponsive in Worker for 3.02s.  This is often caused by long-running GIL-holding functions or moving large chunks of data. This can cause timeouts and instability.
2023-05-04 16:46:37,653 - distributed.core - INFO - Removing comms to tcp://172.16.3.83:42714
2023-05-04 16:46:37,732 - distributed.worker - ERROR - Worker stream died during communication: tcp://172.16.3.83:42714
Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 235, in read
    n = await stream.read_into(chunk)
tornado.iostream.StreamClosedError: Stream is closed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/worker.py", line 2060, in gather_dep
    response = await get_data_from_worker(
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/worker.py", line 2895, in get_data_from_worker
    response = await send_recv(
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/core.py", line 1028, in send_recv
    response = await comm.read(deserializers=deserializers)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 241, in read
    convert_stream_closed_error(self, e)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 144, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc}") from exc
distributed.comm.core.CommClosedError: in <TCP (closed) Ephemeral Worker->Worker for gather local=tcp://172.16.3.103:58390 remote=tcp://172.16.3.83:42714>: Stream is closed
2023-05-04 16:46:48,617 - distributed.core - INFO - Event loop was unresponsive in Worker for 4.15s.  This is often caused by long-running GIL-holding functions or moving large chunks of data. This can cause timeouts and instability.
2023-05-04 16:47:00,178 - distributed.core - INFO - Event loop was unresponsive in Worker for 4.00s.  This is often caused by long-running GIL-holding functions or moving large chunks of data. This can cause timeouts and instability.
2023-05-04 16:47:00,249 - distributed.worker - ERROR - failed during get data with tcp://172.16.3.103:34301 -> tcp://172.16.3.83:42714
Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/tornado/iostream.py", line 861, in _read_to_buffer
    bytes_read = self.read_from_fd(buf)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/tornado/iostream.py", line 1116, in read_from_fd
    return self.socket.recv_into(buf, len(buf))
ConnectionResetError: [Errno 104] Connection reset by peer

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/worker.py", line 1787, in get_data
    response = await comm.read(deserializers=serializers)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 241, in read
    convert_stream_closed_error(self, e)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 142, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc.__class__.__name__}: {exc}") from exc
distributed.comm.core.CommClosedError: in <TCP (closed)  local=tcp://172.16.3.103:34301 remote=tcp://172.16.3.83:36824>: ConnectionResetError: [Errno 104] Connection reset by peer
2023-05-04 16:47:00,255 - distributed.core - INFO - Lost connection to 'tcp://172.16.3.83:36824'
Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/tornado/iostream.py", line 861, in _read_to_buffer
    bytes_read = self.read_from_fd(buf)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/tornado/iostream.py", line 1116, in read_from_fd
    return self.socket.recv_into(buf, len(buf))
ConnectionResetError: [Errno 104] Connection reset by peer

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/core.py", line 832, in _handle_comm
    result = await result
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/core.py", line 991, in wrapper
    return await func(self, *args, **kwargs)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/worker.py", line 1787, in get_data
    response = await comm.read(deserializers=serializers)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 241, in read
    convert_stream_closed_error(self, e)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 142, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc.__class__.__name__}: {exc}") from exc
distributed.comm.core.CommClosedError: in <TCP (closed)  local=tcp://172.16.3.103:34301 remote=tcp://172.16.3.83:36824>: ConnectionResetError: [Errno 104] Connection reset by peer
2023-05-04 16:47:11,871 - distributed.core - INFO - Event loop was unresponsive in Worker for 3.98s.  This is often caused by long-running GIL-holding functions or moving large chunks of data. This can cause timeouts and instability.
2023-05-04 16:47:24,910 - distributed.core - INFO - Event loop was unresponsive in Worker for 5.66s.  This is often caused by long-running GIL-holding functions or moving large chunks of data. This can cause timeouts and instability.
2023-05-04 16:47:39,636 - distributed.utils_perf - INFO - full garbage collection released 18.43 MiB from 679 reference cycles (threshold: 9.54 MiB)
2023-05-04 16:47:39,661 - distributed.core - INFO - Event loop was unresponsive in Worker for 4.95s.  This is often caused by long-running GIL-holding functions or moving large chunks of data. This can cause timeouts and instability.
2023-05-04 16:47:50,890 - distributed.utils_perf - WARNING - full garbage collections took 14% CPU time recently (threshold: 10%)
2023-05-04 16:47:51,053 - distributed.core - INFO - Event loop was unresponsive in Worker for 4.67s.  This is often caused by long-running GIL-holding functions or moving large chunks of data. This can cause timeouts and instability.
2023-05-04 16:48:00,301 - distributed.core - INFO - Event loop was unresponsive in Worker for 8.38s.  This is often caused by long-running GIL-holding functions or moving large chunks of data. This can cause timeouts and instability.
2023-05-04 16:48:03,974 - distributed.core - INFO - Event loop was unresponsive in Worker for 3.67s.  This is often caused by long-running GIL-holding functions or moving large chunks of data. This can cause timeouts and instability.
2023-05-04 16:48:16,208 - distributed.utils_perf - WARNING - full garbage collections took 18% CPU time recently (threshold: 10%)
2023-05-04 16:48:56,873 - distributed.utils_perf - WARNING - full garbage collections took 26% CPU time recently (threshold: 10%)
2023-05-04 16:49:00,326 - distributed.utils_perf - WARNING - full garbage collections took 26% CPU time recently (threshold: 10%)
2023-05-04 16:49:05,939 - distributed.utils_perf - WARNING - full garbage collections took 26% CPU time recently (threshold: 10%)
2023-05-04 16:49:40,024 - distributed.utils_perf - WARNING - full garbage collections took 25% CPU time recently (threshold: 10%)
2023-05-04 16:50:03,551 - distributed.utils_perf - WARNING - full garbage collections took 25% CPU time recently (threshold: 10%)
2023-05-04 16:50:31,846 - distributed.utils_perf - WARNING - full garbage collections took 24% CPU time recently (threshold: 10%)
2023-05-04 16:50:44,656 - distributed.utils_perf - WARNING - full garbage collections took 24% CPU time recently (threshold: 10%)
2023-05-04 16:50:57,848 - distributed.utils_perf - WARNING - full garbage collections took 24% CPU time recently (threshold: 10%)
2023-05-04 16:51:16,358 - distributed.utils_perf - WARNING - full garbage collections took 24% CPU time recently (threshold: 10%)
2023-05-04 16:52:02,026 - distributed.utils_perf - WARNING - full garbage collections took 22% CPU time recently (threshold: 10%)
2023-05-04 16:52:04,142 - distributed.utils_perf - WARNING - full garbage collections took 22% CPU time recently (threshold: 10%)
2023-05-04 16:53:49,733 - distributed.utils_perf - WARNING - full garbage collections took 20% CPU time recently (threshold: 10%)
2023-05-04 16:54:07,982 - distributed.core - INFO - Connection to tcp://172.16.3.106:43862 has been closed.
2023-05-04 16:54:07,984 - distributed.worker - INFO - Stopping worker at tcp://172.16.3.103:34301. Reason: worker-handle-scheduler-connection-broken
2023-05-04 16:54:07,999 - distributed.batched - INFO - Batched Comm Closed <TCP (closed) Worker->Scheduler local=tcp://172.16.3.103:32963 remote=tcp://172.16.3.106:43862>
Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/batched.py", line 115, in _background_send
    nbytes = yield coro
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/tornado/gen.py", line 767, in run
    value = future.result()
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 269, in write
    raise CommClosedError()
distributed.comm.core.CommClosedError
2023-05-04 16:54:08,042 - distributed.nanny - INFO - Closing Nanny gracefully at 'tcp://172.16.3.103:45826'. Reason: worker-handle-scheduler-connection-broken
2023-05-04 16:54:08,080 - distributed.worker - ERROR - failed during get data with tcp://172.16.3.103:34301 -> tcp://172.16.3.82:33831
Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 317, in write
    raise StreamClosedError()
tornado.iostream.StreamClosedError: Stream is closed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/worker.py", line 1786, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 328, in write
    convert_stream_closed_error(self, e)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 144, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc}") from exc
distributed.comm.core.CommClosedError: in <TCP (closed)  local=tcp://172.16.3.103:34301 remote=tcp://172.16.3.82:47286>: Stream is closed
2023-05-04 16:54:08,099 - distributed.worker - ERROR - failed during get data with tcp://172.16.3.103:34301 -> tcp://172.16.3.102:38857
Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 317, in write
    raise StreamClosedError()
tornado.iostream.StreamClosedError: Stream is closed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/worker.py", line 1786, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 328, in write
    convert_stream_closed_error(self, e)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 144, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc}") from exc
distributed.comm.core.CommClosedError: in <TCP (closed)  local=tcp://172.16.3.103:34301 remote=tcp://172.16.3.102:55304>: Stream is closed
2023-05-04 16:54:08,146 - distributed.worker - ERROR - failed during get data with tcp://172.16.3.103:34301 -> tcp://172.16.3.189:34085
Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 317, in write
    raise StreamClosedError()
tornado.iostream.StreamClosedError: Stream is closed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/worker.py", line 1786, in get_data
    compressed = await comm.write(msg, serializers=serializers)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 328, in write
    convert_stream_closed_error(self, e)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 144, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc}") from exc
distributed.comm.core.CommClosedError: in <TCP (closed)  local=tcp://172.16.3.103:34301 remote=tcp://172.16.3.189:43017>: Stream is closed
2023-05-04 16:54:08,500 - distributed.worker - ERROR - failed during get data with tcp://172.16.3.103:34301 -> tcp://172.16.3.104:39749
Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/tornado/iostream.py", line 861, in _read_to_buffer
    bytes_read = self.read_from_fd(buf)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/tornado/iostream.py", line 1116, in read_from_fd
    return self.socket.recv_into(buf, len(buf))
ConnectionResetError: [Errno 104] Connection reset by peer

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/worker.py", line 1787, in get_data
    response = await comm.read(deserializers=serializers)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 241, in read
    convert_stream_closed_error(self, e)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 142, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc.__class__.__name__}: {exc}") from exc
distributed.comm.core.CommClosedError: in <TCP (closed)  local=tcp://172.16.3.103:34301 remote=tcp://172.16.3.104:46363>: ConnectionResetError: [Errno 104] Connection reset by peer
2023-05-04 16:54:10,150 - distributed.client - ERROR - 
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/core.py", line 292, in connect
    comm = await wait_for(
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/utils.py", line 1878, in wait_for
    return await asyncio.wait_for(fut, timeout)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 511, in connect
    convert_stream_closed_error(self, e)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/tcp.py", line 142, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc.__class__.__name__}: {exc}") from exc
distributed.comm.core.CommClosedError: in <distributed.comm.tcp.TCPConnector object at 0x2ab08eab7b20>: ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/utils.py", line 754, in wrapper
    return await func(*args, **kwargs)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/client.py", line 1323, in _reconnect
    await self._ensure_connected(timeout=timeout)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/client.py", line 1353, in _ensure_connected
    comm = await connect(
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/site-packages/distributed/comm/core.py", line 316, in connect
    await asyncio.sleep(backoff)
  File "/vortexfs1/home/anthony.meza/mambaforge/envs/atm_rivers/lib/python3.10/asyncio/tasks.py", line 605, in sleep
    return await future
asyncio.exceptions.CancelledError
2023-05-04 16:54:10,163 - distributed.nanny - INFO - Worker closed
2023-05-04 16:54:12,166 - distributed.nanny - ERROR - Worker process died unexpectedly
2023-05-04 16:54:19,410 - distributed.nanny - INFO - Closing Nanny at 'tcp://172.16.3.103:45826'. Reason: nanny-close-gracefully
2023-05-04 16:54:19,411 - distributed.dask_worker - INFO - End worker
